Only in hugin-new/.hg/cache: branchheads-base
Only in hugin-new/.hg/cache: tags
diff -r -c hugin/CMakeLists.txt hugin-new/CMakeLists.txt
*** hugin/CMakeLists.txt	Thu Sep 27 16:36:54 2018
--- hugin-new/CMakeLists.txt	Thu Sep 27 18:58:00 2018
***************
*** 433,438 ****
--- 433,440 ----
  FIND_PACKAGE(SQLite3 REQUIRED)
  INCLUDE_DIRECTORIES(${SQLITE3_INCLUDE_DIR})
  
+ OPTION(UNIX_SELF_CONTAINED_BUNDLE "Build a self-contained bundle under Unix systems" OFF)
+ 
  OPTION(BUILD_HSI "Python Scripting Interface" OFF)
  
  IF(BUILD_HSI)
Only in hugin-new: rev.txt
diff -r -c hugin/src/hugin1/hugin/huginApp.cpp hugin-new/src/hugin1/hugin/huginApp.cpp
*** hugin/src/hugin1/hugin/huginApp.cpp	Thu Sep 27 16:36:59 2018
--- hugin-new/src/hugin1/hugin/huginApp.cpp	Thu Sep 27 21:48:16 2018
***************
*** 57,65 ****
  #include "base_wx/platform.h"
  #include "base_wx/huginConfig.h"
  #include <wx/cshelp.h>
  #ifdef __WXMSW__
  #include <wx/dir.h>
- #include <wx/stdpaths.h>
  #if wxCHECK_VERSION(3,1,0)
  #include <wx/taskbarbutton.h>
  #endif
--- 57,65 ----
  #include "base_wx/platform.h"
  #include "base_wx/huginConfig.h"
  #include <wx/cshelp.h>
+ #include <wx/stdpaths.h>
  #ifdef __WXMSW__
  #include <wx/dir.h>
  #if wxCHECK_VERSION(3,1,0)
  #include <wx/taskbarbutton.h>
  #endif
***************
*** 250,256 ****
      }
  #endif
      
! 	
  #else
      // add the locale directory specified during configure
      m_xrcPrefix = wxT(INSTALL_XRC_DIR);
--- 250,269 ----
      }
  #endif
      
! #elif defined UNIX_SELF_CONTAINED_BUNDLE
!     // initialize paths
!     {
!       wxFileName exePath(wxStandardPaths::Get().GetExecutablePath());
!       m_utilsBinDir = exePath.GetPath(wxPATH_GET_VOLUME | wxPATH_GET_SEPARATOR);
!       exePath.RemoveLastDir();
!       const wxString huginRoot=exePath.GetPath(wxPATH_GET_VOLUME | wxPATH_GET_SEPARATOR);
!       m_xrcPrefix = huginRoot + wxT("share/hugin/xrc/");
!       m_DataDir = huginRoot + wxT("share/hugin/data/");
! 
!       // locale setup
!       locale.AddCatalogLookupPathPrefix(huginRoot + wxT("share/locale"));
!     }
! 
  #else
      // add the locale directory specified during configure
      m_xrcPrefix = wxT(INSTALL_XRC_DIR);
diff -r -c hugin/src/hugin1/ptbatcher/PTBatcherGUI.cpp hugin-new/src/hugin1/ptbatcher/PTBatcherGUI.cpp
*** hugin/src/hugin1/ptbatcher/PTBatcherGUI.cpp	Thu Sep 27 16:36:55 2018
--- hugin-new/src/hugin1/ptbatcher/PTBatcherGUI.cpp	Sat Sep 29 11:53:49 2018
***************
*** 26,31 ****
--- 26,34 ----
  
  #include "PTBatcherGUI.h"
  #include <wx/cshelp.h>
+ #ifdef UNIX_SELF_CONTAINED_BUNDLE
+ #include <wx/stdpaths.h>
+ #endif
  #ifdef __WXMSW__
  #include <wx/stdpaths.h>
  #endif
***************
*** 102,107 ****
--- 105,122 ----
          }
  
      }
+ 
+ #elif defined UNIX_SELF_CONTAINED_BUNDLE
+     // initialize paths
+     {
+       wxFileName exePath(wxStandardPaths::Get().GetExecutablePath());
+       exePath.RemoveLastDir();
+       const wxString huginRoot(exePath.GetPath(wxPATH_GET_VOLUME | wxPATH_GET_SEPARATOR));
+       m_xrcPrefix = huginRoot + wxT("share/hugin/xrc/");
+ 
+       // locale setup
+       m_locale.AddCatalogLookupPathPrefix(huginRoot + wxT("share/locale"));
+     }
  #else
      // add the locale directory specified during configure
      m_xrcPrefix = wxT(INSTALL_XRC_DIR);
diff -r -c hugin/src/hugin_config.h.in.cmake hugin-new/src/hugin_config.h.in.cmake
*** hugin/src/hugin_config.h.in.cmake	Thu Sep 27 16:36:58 2018
--- hugin-new/src/hugin_config.h.in.cmake	Thu Sep 27 18:53:12 2018
***************
*** 31,34 ****
--- 31,37 ----
  /* if using EGL for OpenGL initialization */
  #cmakedefine HAVE_EGL 1
  
+ /* Build a fully self contained OSX bundle (with embedded ressources) */
+ #cmakedefine UNIX_SELF_CONTAINED_BUNDLE 1
+ 
  #endif
